\"\"\"\nThis file contains the exact code changes needed to integrate the Personal Memory System.\nApply these changes to main.py and admin.py.\n\"\"\"\n\n# === CHANGES FOR main.py ===\n\n# 1. ADD THESE IMPORTS at the top (after other imports):\nMEMORY_IMPORTS = \"\"\"\n# Personal Memory System\nfrom personal_memory import PersonalMemorySystem\nfrom memory_integration import MemoryIntegrator\nfrom admin_memory import router as memory_admin_router, init_memory_admin\n\"\"\"\n\n# 2. ADD THIS GLOBAL VARIABLE (after other globals like cfg, db, etc.):\nMEMORY_GLOBAL = \"\"\"\n# Memory system\nmemory_integrator: MemoryIntegrator = None\n\"\"\"\n\n# 3. IN lifespan() FUNCTION - ADD AFTER db initialization:\nLIFESPAN_INIT = \"\"\"\n    # Initialize Personal Memory System\n    memory_integrator = MemoryIntegrator(DB_PATH, cfg)\n    await memory_integrator.initialize()\n    logger.info(\"âœ… Personal Memory System initialized\")\n\"\"\"\n\n# 4. IN lifespan() FUNCTION - ADD TO admin_init() call:\nADMIN_INIT_UPDATE = \"\"\"\n    admin_init(cfg, plugin_manager, model_router, db, task_queue, skills_engine, memory_integrator)\n    init_memory_admin(memory_integrator)  # Initialize memory admin endpoints\n\"\"\"\n\n# 5. IN lifespan() shutdown section - ADD:\nLIFESPAN_SHUTDOWN = \"\"\"\n    # Shutdown memory system\n    if memory_integrator:\n        await memory_integrator.close()\n        logger.info(\"Memory system closed\")\n\"\"\"\n\n# 6. ADD AFTER app initialization (after other app includes):\nAPP_INCLUDE_ROUTER = \"\"\"\n# Include memory admin router\napp.include_router(memory_admin_router)\n\"\"\"\n\n# 7. MODIFY process_message() - ADD at start (after text.strip()):\nPROCESS_MESSAGE_START = \"\"\"\n    # Get or create conversation with memory tracking\n    conv = None\n    convs = await db.list_conversations(limit=1)\n    if not hasattr(process_message, '_tg_convs'):\n        process_message._tg_convs = {}\n    conv_id = process_message._tg_convs.get(user_id)\n    if conv_id:\n        conv = await db.get_conversation(conv_id)\n    if not conv:\n        conv_id = f\"conv-{uuid.uuid4().hex[:8]}\"\n        await db.create_conversation(conv_id